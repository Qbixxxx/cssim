const { app, BrowserWindow, ipcMain, screen, session } = require('electron');
const path = require('path');
const fs = require('fs');

const { copyProjectToRender, analyzeMediaQueries, transformAllCSS, appendScriptToAllHTMLFilesInRender } = require('./render');

let newWin1 = null;
let originalWidth = null;
let originalHeight = null;
let watchInterval = null;

function centerWindow(width, height) {
    if (!newWin1) return;
    const { width: screenWidth, height: screenHeight } = screen.getPrimaryDisplay().workAreaSize;
    const x = Math.floor((screenWidth - width) / 2);
    const y = Math.floor((screenHeight - height) / 2);
    newWin1.setBounds({ x, y, width, height });
}

// ðŸ§  ObsÅ‚uga IPC
ipcMain.on('app-quit', () => app.quit());

ipcMain.on('close-current-window', event => {
    const win = BrowserWindow.fromWebContents(event.sender);
    if (win) win.close();
});

ipcMain.on('close-newWin1', () => {
    if (newWin1 && !newWin1.isDestroyed()) {
        newWin1.close();
    }
});

ipcMain.handle('copy-project-files', async () => {
    try {
        return copyProjectToRender();
    } catch (err) {
        console.error('Failed to copy project:', err);
        return false;
    }
});

ipcMain.handle('analyze-media-queries', async () => {
    try {
        await analyzeMediaQueries();
        return true;
    } catch (err) {
        console.error('Failed to analyze media queries:', err);
        return false;
    }
});

ipcMain.handle('transform-css', async () => {
    try {
        await transformAllCSS();
        return true;
    } catch (err) {
        console.error('Failed to transform CSS:', err);
        return false;
    }
});

ipcMain.handle('append-script-to-html', async () => {
    try {
        await appendScriptToAllHTMLFilesInRender();
        return true;
    } catch (e) {
        console.error('BÅ‚Ä…d dopisywania skryptu:', e);
        return false;
    }
});

const jsonPath = path.join(__dirname, 'emulator/panel.json');
ipcMain.handle('save-json', async (_event, updates) => {
    try {
        const fileContent = fs.readFileSync(jsonPath, 'utf8');
        const json = JSON.parse(fileContent);
        const updated = { ...json, ...updates };
        fs.writeFileSync(jsonPath, JSON.stringify(updated, null, 2), 'utf8');
        return true;
    } catch (err) {
        console.error('Failed to save data in JSON file:', err);
        return false;
    }
});

const cssFilePath = path.join(__dirname, 'emulator', 'environment-variables.css');

let cssVariables = {
    '--emulator-safe-area-inset-left': '0',
    '--emulator-safe-area-inset-right': '0',
    '--emulator-safe-area-inset-top': '0',
    '--emulator-safe-area-inset-bottom': '0',
    '--emulator-titlebar-area-width': '0',
    '--emulator-titlebar-area-height': '0',
    '--emulator-titlebar-area-x': '0',
    '--emulator-titlebar-area-y': '0'
};

// Funkcja nadpisujÄ…ca plik CSS kompletnym zestawem zmiennych
let contrasttype = 'none';
function saveVariablesToFile(vars) {
    const lines = [':root {'];
    for (const [key, value] of Object.entries(vars)) {
        lines.push(`  ${key}: ${value};`);
    }
    lines.push('}');
    if (contrasttype == 'aquatic') {
        lines.push(
            'a.emulator-forced-colors-active-forced, button.emulator-forced-colors-active-forced, dialog.emulator-forced-colors-active-forced, input.emulator-forced-colors-active-forced, select.emulator-forced-colors-active-forced, abbr.emulator-forced-colors-active-forced, address.emulator-forced-colors-active-forced, area.emulator-forced-colors-active-forced, article.emulator-forced-colors-active-forced, aside.emulator-forced-colors-active-forced, audio.emulator-forced-colors-active-forced, b.emulator-forced-colors-active-forced, base.emulator-forced-colors-active-forced, bdi.emulator-forced-colors-active-forced, bdo.emulator-forced-colors-active-forced, blockquote.emulator-forced-colors-active-forced, body.emulator-forced-colors-active-forced, br.emulator-forced-colors-active-forced, canvas.emulator-forced-colors-active-forced, caption.emulator-forced-colors-active-forced, cite.emulator-forced-colors-active-forced, code.emulator-forced-colors-active-forced, col.emulator-forced-colors-active-forced, colgroup.emulator-forced-colors-active-forced, data.emulator-forced-colors-active-forced, datalist.emulator-forced-colors-active-forced, dd.emulator-forced-colors-active-forced, del.emulator-forced-colors-active-forced, details.emulator-forced-colors-active-forced, dfn.emulator-forced-colors-active-forced, div.emulator-forced-colors-active-forced, dl.emulator-forced-colors-active-forced, dt.emulator-forced-colors-active-forced, em.emulator-forced-colors-active-forced, embed.emulator-forced-colors-active-forced, figcaption.emulator-forced-colors-active-forced, figure.emulator-forced-colors-active-forced, footer.emulator-forced-colors-active-forced, form.emulator-forced-colors-active-forced, h1.emulator-forced-colors-active-forced, h2.emulator-forced-colors-active-forced, h3.emulator-forced-colors-active-forced, h4.emulator-forced-colors-active-forced, h5.emulator-forced-colors-active-forced, h6.emulator-forced-colors-active-forced, head.emulator-forced-colors-active-forced, header.emulator-forced-colors-active-forced, hgroup.emulator-forced-colors-active-forced, hr.emulator-forced-colors-active-forced, html.emulator-forced-colors-active-forced, i.emulator-forced-colors-active-forced, iframe.emulator-forced-colors-active-forced, img.emulator-forced-colors-active-forced, ins.emulator-forced-colors-active-forced, kbd.emulator-forced-colors-active-forced, label.emulator-forced-colors-active-forced, legend.emulator-forced-colors-active-forced, li.emulator-forced-colors-active-forced, link.emulator-forced-colors-active-forced, main.emulator-forced-colors-active-forced, map.emulator-forced-colors-active-forced, math.emulator-forced-colors-active-forced, menu.emulator-forced-colors-active-forced, meta.emulator-forced-colors-active-forced, meter.emulator-forced-colors-active-forced, nav.emulator-forced-colors-active-forced, noscript.emulator-forced-colors-active-forced, object.emulator-forced-colors-active-forced, ol.emulator-forced-colors-active-forced, optgroup.emulator-forced-colors-active-forced, option.emulator-forced-colors-active-forced, output.emulator-forced-colors-active-forced, p.emulator-forced-colors-active-forced, picture.emulator-forced-colors-active-forced, pre.emulator-forced-colors-active-forced, progress.emulator-forced-colors-active-forced, q.emulator-forced-colors-active-forced, rp.emulator-forced-colors-active-forced, rt.emulator-forced-colors-active-forced, ruby.emulator-forced-colors-active-forced, s.emulator-forced-colors-active-forced, samp.emulator-forced-colors-active-forced, script.emulator-forced-colors-active-forced, search.emulator-forced-colors-active-forced, section.emulator-forced-colors-active-forced, selectedcontent.emulator-forced-colors-active-forced, slot.emulator-forced-colors-active-forced, small.emulator-forced-colors-active-forced, source.emulator-forced-colors-active-forced, span.emulator-forced-colors-active-forced, strong.emulator-forced-colors-active-forced, style.emulator-forced-colors-active-forced, sub.emulator-forced-colors-active-forced, summary.emulator-forced-colors-active-forced, sup.emulator-forced-colors-active-forced, svg.emulator-forced-colors-active-forced, table.emulator-forced-colors-active-forced, tbody.emulator-forced-colors-active-forced, track.emulator-forced-colors-active-forced, wbr.emulator-forced-colors-active-forced { color: rgb(255, 255, 255) !important; border-left-color: rgb(255, 255, 255) !important; border-right-color: rgb(255, 255, 255) !important; border-top-color: rgb(255, 255, 255) !important; border-bottom-color: rgb(255, 255, 255) !important; border-inline-start-color: rgb(255, 255, 255) !important; border-inline-end-color: rgb(255, 255, 255) !important; border-block-start-color: rgb(255, 255, 255) !important; border-block-end-color: rgb(255, 255, 255) !important; outline-color: rgb(255, 255, 255) !important; -webkit-tap-highlight-color: rgba(0, 0, 0, 0.18) !important; fill: rgb(0, 0, 0) !important; stroke: none !important; box-shadow: none !important; text-shadow: none !important; background-image: none !important; scrollbar-color: auto !important;}a.emulator-forced-colors-active-forced, abbr.emulator-forced-colors-active-forced, address.emulator-forced-colors-active-forced, area.emulator-forced-colors-active-forced, article.emulator-forced-colors-active-forced, aside.emulator-forced-colors-active-forced, audio.emulator-forced-colors-active-forced, b.emulator-forced-colors-active-forced, base.emulator-forced-colors-active-forced, bdi.emulator-forced-colors-active-forced, bdo.emulator-forced-colors-active-forced, blockquote.emulator-forced-colors-active-forced, body.emulator-forced-colors-active-forced, br.emulator-forced-colors-active-forced, canvas.emulator-forced-colors-active-forced, caption.emulator-forced-colors-active-forced, cite.emulator-forced-colors-active-forced, code.emulator-forced-colors-active-forced, col.emulator-forced-colors-active-forced, colgroup.emulator-forced-colors-active-forced, data.emulator-forced-colors-active-forced, datalist.emulator-forced-colors-active-forced, dd.emulator-forced-colors-active-forced, del.emulator-forced-colors-active-forced, details.emulator-forced-colors-active-forced, dfn.emulator-forced-colors-active-forced, div.emulator-forced-colors-active-forced, dl.emulator-forced-colors-active-forced, dt.emulator-forced-colors-active-forced, em.emulator-forced-colors-active-forced, embed.emulator-forced-colors-active-forced, fieldset.emulator-forced-colors-active-forced, figcaption.emulator-forced-colors-active-forced, figure.emulator-forced-colors-active-forced, footer.emulator-forced-colors-active-forced, form.emulator-forced-colors-active-forced, h1.emulator-forced-colors-active-forced, h2.emulator-forced-colors-active-forced, h3.emulator-forced-colors-active-forced, h4.emulator-forced-colors-active-forced, h5.emulator-forced-colors-active-forced, h6.emulator-forced-colors-active-forced, head.emulator-forced-colors-active-forced, header.emulator-forced-colors-active-forced, hgroup.emulator-forced-colors-active-forced, hr.emulator-forced-colors-active-forced, html.emulator-forced-colors-active-forced, i.emulator-forced-colors-active-forced, iframe.emulator-forced-colors-active-forced, img.emulator-forced-colors-active-forced, ins.emulator-forced-colors-active-forced, kbd.emulator-forced-colors-active-forced, label.emulator-forced-colors-active-forced, legend.emulator-forced-colors-active-forced, li.emulator-forced-colors-active-forced, link.emulator-forced-colors-active-forced, main.emulator-forced-colors-active-forced, map.emulator-forced-colors-active-forced, math.emulator-forced-colors-active-forced, menu.emulator-forced-colors-active-forced, meta.emulator-forced-colors-active-forced, meter.emulator-forced-colors-active-forced, nav.emulator-forced-colors-active-forced, noscript.emulator-forced-colors-active-forced, object.emulator-forced-colors-active-forced, ol.emulator-forced-colors-active-forced, optgroup.emulator-forced-colors-active-forced, option.emulator-forced-colors-active-forced, output.emulator-forced-colors-active-forced, p.emulator-forced-colors-active-forced, picture.emulator-forced-colors-active-forced, pre.emulator-forced-colors-active-forced, progress.emulator-forced-colors-active-forced, q.emulator-forced-colors-active-forced, rp.emulator-forced-colors-active-forced, rt.emulator-forced-colors-active-forced, ruby.emulator-forced-colors-active-forced, s.emulator-forced-colors-active-forced, samp.emulator-forced-colors-active-forced, script.emulator-forced-colors-active-forced, search.emulator-forced-colors-active-forced, section.emulator-forced-colors-active-forced, selectedcontent.emulator-forced-colors-active-forced, slot.emulator-forced-colors-active-forced, small.emulator-forced-colors-active-forced, source.emulator-forced-colors-active-forced, span.emulator-forced-colors-active-forced, strong.emulator-forced-colors-active-forced, style.emulator-forced-colors-active-forced, sub.emulator-forced-colors-active-forced, summary.emulator-forced-colors-active-forced, sup.emulator-forced-colors-active-forced, svg.emulator-forced-colors-active-forced, table.emulator-forced-colors-active-forced, tbody.emulator-forced-colors-active-forced, track.emulator-forced-colors-active-forced, wbr.emulator-forced-colors-active-forced { background-color: rgba(32, 32, 32, 0) !important; text-decoration-color: rgb(0, 0, 0) !important; text-emphasis-color: rgb(0, 0, 0) !important; column-rule-color: rgb(0, 0, 0) !important;}button.emulator-forced-colors-active-forced, dialog.emulator-forced-colors-active-forced, input.emulator-forced-colors-active-forced, select.emulator-forced-colors-active-forced { background-color: rgb(32, 32, 32) !important; text-decoration-color: rgb(255, 255, 255) !important; text-emphasis-color: rgb(255, 255, 255) !important; column-rule-color: rgb(255, 255, 255) !important;}fieldset.emulator-forced-colors-active-forced, mark.emulator-forced-colors-active-forced { -webkit-tap-highlight-color: rgba(0, 0, 0, 0.18) !important; fill: rgb(0, 0, 0) !important; stroke: none !important; box-shadow: none !important; text-shadow: none !important; background-image: none !important; scrollbar-color: auto !important;}fieldset.emulator-forced-colors-active-forced { color: rgb(255, 255, 255) !important; border-left-color: rgb(32, 32, 32) !important; border-right-color: rgb(32, 32, 32) !important; border-top-color: rgb(32, 32, 32) !important; border-bottom-color: rgb(32, 32, 32) !important; border-inline-start-color: rgb(32, 32, 32) !important; border-inline-end-color: rgb(32, 32, 32) !important; border-block-start-color: rgb(32, 32, 32) !important; border-block-end-color: rgb(32, 32, 32) !important; outline-color: rgb(255, 255, 255) !important;}mark.emulator-forced-colors-active-forced { color: rgb(0, 0, 0) !important; background-color: rgb(255, 255, 0) !important; text-decoration-color: rgb(0, 0, 0) !important; text-emphasis-color: rgb(0, 0, 0) !important; border-left-color: rgb(0, 0, 0) !important; border-right-color: rgb(0, 0, 0) !important; border-top-color: rgb(0, 0, 0) !important; border-bottom-color: rgb(0, 0, 0) !important; border-inline-start-color: rgb(0, 0, 0) !important; border-inline-end-color: rgb(0, 0, 0) !important; border-block-start-color: rgb(0, 0, 0) !important; border-block-end-color: rgb(0, 0, 0) !important; outline-color: rgb(0, 0, 0) !important; column-rule-color: rgb(0, 0, 0) !important;} body.emulator-forced-colors-active-forced {background-color: rgb(32, 32, 32) !important;}'
        );
    } else if (contrasttype == 'desert') {
        lines.push(
            'a.emulator-forced-colors-active-forced, button.emulator-forced-colors-active-forced, abbr.emulator-forced-colors-active-forced, address.emulator-forced-colors-active-forced, area.emulator-forced-colors-active-forced, article.emulator-forced-colors-active-forced, aside.emulator-forced-colors-active-forced, audio.emulator-forced-colors-active-forced, b.emulator-forced-colors-active-forced, base.emulator-forced-colors-active-forced, bdi.emulator-forced-colors-active-forced, bdo.emulator-forced-colors-active-forced, blockquote.emulator-forced-colors-active-forced, body.emulator-forced-colors-active-forced, br.emulator-forced-colors-active-forced, canvas.emulator-forced-colors-active-forced, caption.emulator-forced-colors-active-forced, cite.emulator-forced-colors-active-forced, code.emulator-forced-colors-active-forced, col.emulator-forced-colors-active-forced, colgroup.emulator-forced-colors-active-forced, data.emulator-forced-colors-active-forced, datalist.emulator-forced-colors-active-forced, dd.emulator-forced-colors-active-forced, del.emulator-forced-colors-active-forced, details.emulator-forced-colors-active-forced, dfn.emulator-forced-colors-active-forced, div.emulator-forced-colors-active-forced, dl.emulator-forced-colors-active-forced, dt.emulator-forced-colors-active-forced, em.emulator-forced-colors-active-forced, embed.emulator-forced-colors-active-forced, fieldset.emulator-forced-colors-active-forced, figcaption.emulator-forced-colors-active-forced, figure.emulator-forced-colors-active-forced, footer.emulator-forced-colors-active-forced, form.emulator-forced-colors-active-forced, h1.emulator-forced-colors-active-forced, h2.emulator-forced-colors-active-forced, h3.emulator-forced-colors-active-forced, h4.emulator-forced-colors-active-forced, h5.emulator-forced-colors-active-forced, h6.emulator-forced-colors-active-forced, head.emulator-forced-colors-active-forced, header.emulator-forced-colors-active-forced, hgroup.emulator-forced-colors-active-forced, hr.emulator-forced-colors-active-forced, html.emulator-forced-colors-active-forced, i.emulator-forced-colors-active-forced, iframe.emulator-forced-colors-active-forced, img.emulator-forced-colors-active-forced, ins.emulator-forced-colors-active-forced, kbd.emulator-forced-colors-active-forced, label.emulator-forced-colors-active-forced, legend.emulator-forced-colors-active-forced, li.emulator-forced-colors-active-forced, link.emulator-forced-colors-active-forced, main.emulator-forced-colors-active-forced, map.emulator-forced-colors-active-forced, mark.emulator-forced-colors-active-forced, math.emulator-forced-colors-active-forced, menu.emulator-forced-colors-active-forced, meta.emulator-forced-colors-active-forced, meter.emulator-forced-colors-active-forced, nav.emulator-forced-colors-active-forced, noscript.emulator-forced-colors-active-forced, object.emulator-forced-colors-active-forced, ol.emulator-forced-colors-active-forced, optgroup.emulator-forced-colors-active-forced, option.emulator-forced-colors-active-forced, output.emulator-forced-colors-active-forced, p.emulator-forced-colors-active-forced, picture.emulator-forced-colors-active-forced, pre.emulator-forced-colors-active-forced, progress.emulator-forced-colors-active-forced, q.emulator-forced-colors-active-forced, rp.emulator-forced-colors-active-forced, rt.emulator-forced-colors-active-forced, ruby.emulator-forced-colors-active-forced, s.emulator-forced-colors-active-forced, samp.emulator-forced-colors-active-forced, script.emulator-forced-colors-active-forced, search.emulator-forced-colors-active-forced, section.emulator-forced-colors-active-forced, selectedcontent.emulator-forced-colors-active-forced, slot.emulator-forced-colors-active-forced, small.emulator-forced-colors-active-forced, source.emulator-forced-colors-active-forced, span.emulator-forced-colors-active-forced, strong.emulator-forced-colors-active-forced, style.emulator-forced-colors-active-forced, sub.emulator-forced-colors-active-forced, summary.emulator-forced-colors-active-forced, sup.emulator-forced-colors-active-forced, svg.emulator-forced-colors-active-forced, table.emulator-forced-colors-active-forced, tbody.emulator-forced-colors-active-forced, track.emulator-forced-colors-active-forced, wbr.emulator-forced-colors-active-forced, dialog.emulator-forced-colors-active-forced, input.emulator-forced-colors-active-forced, select.emulator-forced-colors-active-forced { -webkit-tap-highlight-color: rgba(0, 0, 0, 0.18) !important; fill: rgb(0, 0, 0) !important; stroke: none !important; box-shadow: none !important; text-shadow: none !important; background-image: none !important; scrollbar-color: auto !important;}a.emulator-forced-colors-active-forced, input.emulator-forced-colors-active-forced, abbr.emulator-forced-colors-active-forced, address.emulator-forced-colors-active-forced, area.emulator-forced-colors-active-forced, article.emulator-forced-colors-active-forced, aside.emulator-forced-colors-active-forced, audio.emulator-forced-colors-active-forced, b.emulator-forced-colors-active-forced, base.emulator-forced-colors-active-forced, bdi.emulator-forced-colors-active-forced, bdo.emulator-forced-colors-active-forced, blockquote.emulator-forced-colors-active-forced, body.emulator-forced-colors-active-forced, br.emulator-forced-colors-active-forced, canvas.emulator-forced-colors-active-forced, caption.emulator-forced-colors-active-forced, cite.emulator-forced-colors-active-forced, code.emulator-forced-colors-active-forced, col.emulator-forced-colors-active-forced, colgroup.emulator-forced-colors-active-forced, data.emulator-forced-colors-active-forced, datalist.emulator-forced-colors-active-forced, dd.emulator-forced-colors-active-forced, del.emulator-forced-colors-active-forced, details.emulator-forced-colors-active-forced, dfn.emulator-forced-colors-active-forced, dialog.emulator-forced-colors-active-forced, fieldset.emulator-forced-colors-active-forced, div.emulator-forced-colors-active-forced, dl.emulator-forced-colors-active-forced, dt.emulator-forced-colors-active-forced, em.emulator-forced-colors-active-forced, embed.emulator-forced-colors-active-forced, select.emulator-forced-colors-active-forced, figcaption.emulator-forced-colors-active-forced, figure.emulator-forced-colors-active-forced, footer.emulator-forced-colors-active-forced, form.emulator-forced-colors-active-forced, h1.emulator-forced-colors-active-forced, h2.emulator-forced-colors-active-forced, h3.emulator-forced-colors-active-forced, h4.emulator-forced-colors-active-forced, h5.emulator-forced-colors-active-forced, h6.emulator-forced-colors-active-forced, head.emulator-forced-colors-active-forced, header.emulator-forced-colors-active-forced, hgroup.emulator-forced-colors-active-forced, hr.emulator-forced-colors-active-forced, html.emulator-forced-colors-active-forced, i.emulator-forced-colors-active-forced, iframe.emulator-forced-colors-active-forced, img.emulator-forced-colors-active-forced, ins.emulator-forced-colors-active-forced, kbd.emulator-forced-colors-active-forced, label.emulator-forced-colors-active-forced, legend.emulator-forced-colors-active-forced, li.emulator-forced-colors-active-forced, link.emulator-forced-colors-active-forced, main.emulator-forced-colors-active-forced, map.emulator-forced-colors-active-forced, math.emulator-forced-colors-active-forced, menu.emulator-forced-colors-active-forced, meta.emulator-forced-colors-active-forced, meter.emulator-forced-colors-active-forced, nav.emulator-forced-colors-active-forced, noscript.emulator-forced-colors-active-forced, object.emulator-forced-colors-active-forced, ol.emulator-forced-colors-active-forced, optgroup.emulator-forced-colors-active-forced, option.emulator-forced-colors-active-forced, output.emulator-forced-colors-active-forced, p.emulator-forced-colors-active-forced, picture.emulator-forced-colors-active-forced, pre.emulator-forced-colors-active-forced, progress.emulator-forced-colors-active-forced, q.emulator-forced-colors-active-forced, rp.emulator-forced-colors-active-forced, rt.emulator-forced-colors-active-forced, ruby.emulator-forced-colors-active-forced, s.emulator-forced-colors-active-forced, samp.emulator-forced-colors-active-forced, script.emulator-forced-colors-active-forced, search.emulator-forced-colors-active-forced, section.emulator-forced-colors-active-forced, selectedcontent.emulator-forced-colors-active-forced, slot.emulator-forced-colors-active-forced, small.emulator-forced-colors-active-forced, source.emulator-forced-colors-active-forced, span.emulator-forced-colors-active-forced, strong.emulator-forced-colors-active-forced, style.emulator-forced-colors-active-forced, sub.emulator-forced-colors-active-forced, summary.emulator-forced-colors-active-forced, sup.emulator-forced-colors-active-forced, svg.emulator-forced-colors-active-forced, table.emulator-forced-colors-active-forced, tbody.emulator-forced-colors-active-forced, track.emulator-forced-colors-active-forced, wbr.emulator-forced-colors-active-forced { color: rgb(61, 61, 61) !important; outline-color: rgb(61, 61, 61) !important;}a.emulator-forced-colors-active-forced, dialog.emulator-forced-colors-active-forced, select.emulator-forced-colors-active-forced, abbr.emulator-forced-colors-active-forced, address.emulator-forced-colors-active-forced, area.emulator-forced-colors-active-forced, article.emulator-forced-colors-active-forced, aside.emulator-forced-colors-active-forced, audio.emulator-forced-colors-active-forced, b.emulator-forced-colors-active-forced, base.emulator-forced-colors-active-forced, bdi.emulator-forced-colors-active-forced, bdo.emulator-forced-colors-active-forced, blockquote.emulator-forced-colors-active-forced, body.emulator-forced-colors-active-forced, br.emulator-forced-colors-active-forced, canvas.emulator-forced-colors-active-forced, caption.emulator-forced-colors-active-forced, cite.emulator-forced-colors-active-forced, code.emulator-forced-colors-active-forced, col.emulator-forced-colors-active-forced, colgroup.emulator-forced-colors-active-forced, data.emulator-forced-colors-active-forced, datalist.emulator-forced-colors-active-forced, dd.emulator-forced-colors-active-forced, del.emulator-forced-colors-active-forced, details.emulator-forced-colors-active-forced, dfn.emulator-forced-colors-active-forced, div.emulator-forced-colors-active-forced, dl.emulator-forced-colors-active-forced, dt.emulator-forced-colors-active-forced, em.emulator-forced-colors-active-forced, embed.emulator-forced-colors-active-forced, figcaption.emulator-forced-colors-active-forced, figure.emulator-forced-colors-active-forced, footer.emulator-forced-colors-active-forced, form.emulator-forced-colors-active-forced, h1.emulator-forced-colors-active-forced, h2.emulator-forced-colors-active-forced, h3.emulator-forced-colors-active-forced, h4.emulator-forced-colors-active-forced, h5.emulator-forced-colors-active-forced, h6.emulator-forced-colors-active-forced, head.emulator-forced-colors-active-forced, header.emulator-forced-colors-active-forced, hgroup.emulator-forced-colors-active-forced, hr.emulator-forced-colors-active-forced, html.emulator-forced-colors-active-forced, i.emulator-forced-colors-active-forced, iframe.emulator-forced-colors-active-forced, img.emulator-forced-colors-active-forced, ins.emulator-forced-colors-active-forced, kbd.emulator-forced-colors-active-forced, label.emulator-forced-colors-active-forced, legend.emulator-forced-colors-active-forced, li.emulator-forced-colors-active-forced, link.emulator-forced-colors-active-forced, main.emulator-forced-colors-active-forced, map.emulator-forced-colors-active-forced, math.emulator-forced-colors-active-forced, menu.emulator-forced-colors-active-forced, meta.emulator-forced-colors-active-forced, meter.emulator-forced-colors-active-forced, nav.emulator-forced-colors-active-forced, noscript.emulator-forced-colors-active-forced, object.emulator-forced-colors-active-forced, ol.emulator-forced-colors-active-forced, optgroup.emulator-forced-colors-active-forced, option.emulator-forced-colors-active-forced, output.emulator-forced-colors-active-forced, p.emulator-forced-colors-active-forced, picture.emulator-forced-colors-active-forced, pre.emulator-forced-colors-active-forced, progress.emulator-forced-colors-active-forced, q.emulator-forced-colors-active-forced, rp.emulator-forced-colors-active-forced, rt.emulator-forced-colors-active-forced, ruby.emulator-forced-colors-active-forced, s.emulator-forced-colors-active-forced, samp.emulator-forced-colors-active-forced, script.emulator-forced-colors-active-forced, search.emulator-forced-colors-active-forced, section.emulator-forced-colors-active-forced, selectedcontent.emulator-forced-colors-active-forced, slot.emulator-forced-colors-active-forced, small.emulator-forced-colors-active-forced, source.emulator-forced-colors-active-forced, span.emulator-forced-colors-active-forced, strong.emulator-forced-colors-active-forced, style.emulator-forced-colors-active-forced, sub.emulator-forced-colors-active-forced, summary.emulator-forced-colors-active-forced, sup.emulator-forced-colors-active-forced, svg.emulator-forced-colors-active-forced, table.emulator-forced-colors-active-forced, tbody.emulator-forced-colors-active-forced, track.emulator-forced-colors-active-forced, wbr.emulator-forced-colors-active-forced { border-left-color: rgb(61, 61, 61) !important; border-right-color: rgb(61, 61, 61) !important; border-top-color: rgb(61, 61, 61) !important; border-bottom-color: rgb(61, 61, 61) !important; border-inline-start-color: rgb(61, 61, 61) !important; border-inline-end-color: rgb(61, 61, 61) !important; border-block-start-color: rgb(61, 61, 61) !important; border-block-end-color: rgb(61, 61, 61) !important;}a.emulator-forced-colors-active-forced, mark.emulator-forced-colors-active-forced, abbr.emulator-forced-colors-active-forced, address.emulator-forced-colors-active-forced, area.emulator-forced-colors-active-forced, article.emulator-forced-colors-active-forced, aside.emulator-forced-colors-active-forced, audio.emulator-forced-colors-active-forced, b.emulator-forced-colors-active-forced, base.emulator-forced-colors-active-forced, bdi.emulator-forced-colors-active-forced, bdo.emulator-forced-colors-active-forced, blockquote.emulator-forced-colors-active-forced, body.emulator-forced-colors-active-forced, br.emulator-forced-colors-active-forced, canvas.emulator-forced-colors-active-forced, caption.emulator-forced-colors-active-forced, cite.emulator-forced-colors-active-forced, code.emulator-forced-colors-active-forced, col.emulator-forced-colors-active-forced, colgroup.emulator-forced-colors-active-forced, data.emulator-forced-colors-active-forced, datalist.emulator-forced-colors-active-forced, dd.emulator-forced-colors-active-forced, del.emulator-forced-colors-active-forced, details.emulator-forced-colors-active-forced, dfn.emulator-forced-colors-active-forced, div.emulator-forced-colors-active-forced, dl.emulator-forced-colors-active-forced, dt.emulator-forced-colors-active-forced, em.emulator-forced-colors-active-forced, embed.emulator-forced-colors-active-forced, fieldset.emulator-forced-colors-active-forced, figcaption.emulator-forced-colors-active-forced, figure.emulator-forced-colors-active-forced, footer.emulator-forced-colors-active-forced, form.emulator-forced-colors-active-forced, h1.emulator-forced-colors-active-forced, h2.emulator-forced-colors-active-forced, h3.emulator-forced-colors-active-forced, h4.emulator-forced-colors-active-forced, h5.emulator-forced-colors-active-forced, h6.emulator-forced-colors-active-forced, head.emulator-forced-colors-active-forced, header.emulator-forced-colors-active-forced, hgroup.emulator-forced-colors-active-forced, hr.emulator-forced-colors-active-forced, html.emulator-forced-colors-active-forced, i.emulator-forced-colors-active-forced, iframe.emulator-forced-colors-active-forced, img.emulator-forced-colors-active-forced, ins.emulator-forced-colors-active-forced, kbd.emulator-forced-colors-active-forced, label.emulator-forced-colors-active-forced, legend.emulator-forced-colors-active-forced, li.emulator-forced-colors-active-forced, link.emulator-forced-colors-active-forced, main.emulator-forced-colors-active-forced, map.emulator-forced-colors-active-forced, math.emulator-forced-colors-active-forced, menu.emulator-forced-colors-active-forced, meta.emulator-forced-colors-active-forced, meter.emulator-forced-colors-active-forced, nav.emulator-forced-colors-active-forced, noscript.emulator-forced-colors-active-forced, object.emulator-forced-colors-active-forced, ol.emulator-forced-colors-active-forced, optgroup.emulator-forced-colors-active-forced, option.emulator-forced-colors-active-forced, output.emulator-forced-colors-active-forced, p.emulator-forced-colors-active-forced, picture.emulator-forced-colors-active-forced, pre.emulator-forced-colors-active-forced, progress.emulator-forced-colors-active-forced, q.emulator-forced-colors-active-forced, rp.emulator-forced-colors-active-forced, rt.emulator-forced-colors-active-forced, ruby.emulator-forced-colors-active-forced, s.emulator-forced-colors-active-forced, samp.emulator-forced-colors-active-forced, script.emulator-forced-colors-active-forced, search.emulator-forced-colors-active-forced, section.emulator-forced-colors-active-forced, selectedcontent.emulator-forced-colors-active-forced, slot.emulator-forced-colors-active-forced, small.emulator-forced-colors-active-forced, source.emulator-forced-colors-active-forced, span.emulator-forced-colors-active-forced, strong.emulator-forced-colors-active-forced, style.emulator-forced-colors-active-forced, sub.emulator-forced-colors-active-forced, summary.emulator-forced-colors-active-forced, sup.emulator-forced-colors-active-forced, svg.emulator-forced-colors-active-forced, table.emulator-forced-colors-active-forced, tbody.emulator-forced-colors-active-forced, track.emulator-forced-colors-active-forced, wbr.emulator-forced-colors-active-forced { text-decoration-color: rgb(0, 0, 0) !important; text-emphasis-color: rgb(0, 0, 0) !important; column-rule-color: rgb(0, 0, 0) !important;}a.emulator-forced-colors-active-forced, abbr.emulator-forced-colors-active-forced, address.emulator-forced-colors-active-forced, area.emulator-forced-colors-active-forced, article.emulator-forced-colors-active-forced, aside.emulator-forced-colors-active-forced, audio.emulator-forced-colors-active-forced, b.emulator-forced-colors-active-forced, base.emulator-forced-colors-active-forced, bdi.emulator-forced-colors-active-forced, bdo.emulator-forced-colors-active-forced, blockquote.emulator-forced-colors-active-forced, body.emulator-forced-colors-active-forced, br.emulator-forced-colors-active-forced, canvas.emulator-forced-colors-active-forced, caption.emulator-forced-colors-active-forced, cite.emulator-forced-colors-active-forced, code.emulator-forced-colors-active-forced, col.emulator-forced-colors-active-forced, colgroup.emulator-forced-colors-active-forced, data.emulator-forced-colors-active-forced, datalist.emulator-forced-colors-active-forced, dd.emulator-forced-colors-active-forced, del.emulator-forced-colors-active-forced, details.emulator-forced-colors-active-forced, dfn.emulator-forced-colors-active-forced, div.emulator-forced-colors-active-forced, dl.emulator-forced-colors-active-forced, dt.emulator-forced-colors-active-forced, em.emulator-forced-colors-active-forced, embed.emulator-forced-colors-active-forced, fieldset.emulator-forced-colors-active-forced, figcaption.emulator-forced-colors-active-forced, figure.emulator-forced-colors-active-forced, footer.emulator-forced-colors-active-forced, form.emulator-forced-colors-active-forced, h1.emulator-forced-colors-active-forced, h2.emulator-forced-colors-active-forced, h3.emulator-forced-colors-active-forced, h4.emulator-forced-colors-active-forced, h5.emulator-forced-colors-active-forced, h6.emulator-forced-colors-active-forced, head.emulator-forced-colors-active-forced, header.emulator-forced-colors-active-forced, hgroup.emulator-forced-colors-active-forced, hr.emulator-forced-colors-active-forced, html.emulator-forced-colors-active-forced, i.emulator-forced-colors-active-forced, iframe.emulator-forced-colors-active-forced, img.emulator-forced-colors-active-forced, ins.emulator-forced-colors-active-forced, kbd.emulator-forced-colors-active-forced, label.emulator-forced-colors-active-forced, legend.emulator-forced-colors-active-forced, li.emulator-forced-colors-active-forced, link.emulator-forced-colors-active-forced, main.emulator-forced-colors-active-forced, map.emulator-forced-colors-active-forced, math.emulator-forced-colors-active-forced, menu.emulator-forced-colors-active-forced, meta.emulator-forced-colors-active-forced, meter.emulator-forced-colors-active-forced, nav.emulator-forced-colors-active-forced, noscript.emulator-forced-colors-active-forced, object.emulator-forced-colors-active-forced, ol.emulator-forced-colors-active-forced, optgroup.emulator-forced-colors-active-forced, option.emulator-forced-colors-active-forced, output.emulator-forced-colors-active-forced, p.emulator-forced-colors-active-forced, picture.emulator-forced-colors-active-forced, pre.emulator-forced-colors-active-forced, progress.emulator-forced-colors-active-forced, q.emulator-forced-colors-active-forced, rp.emulator-forced-colors-active-forced, rt.emulator-forced-colors-active-forced, ruby.emulator-forced-colors-active-forced, s.emulator-forced-colors-active-forced, samp.emulator-forced-colors-active-forced, script.emulator-forced-colors-active-forced, search.emulator-forced-colors-active-forced, section.emulator-forced-colors-active-forced, selectedcontent.emulator-forced-colors-active-forced, slot.emulator-forced-colors-active-forced, small.emulator-forced-colors-active-forced, source.emulator-forced-colors-active-forced, span.emulator-forced-colors-active-forced, strong.emulator-forced-colors-active-forced, style.emulator-forced-colors-active-forced, sub.emulator-forced-colors-active-forced, summary.emulator-forced-colors-active-forced, sup.emulator-forced-colors-active-forced, svg.emulator-forced-colors-active-forced, table.emulator-forced-colors-active-forced, tbody.emulator-forced-colors-active-forced, track.emulator-forced-colors-active-forced, wbr.emulator-forced-colors-active-forced { background-color: rgba(255, 250, 239, 0) !important;}button.emulator-forced-colors-active-forced, dialog.emulator-forced-colors-active-forced, select.emulator-forced-colors-active-forced { background-color: rgb(255, 250, 239) !important;}dialog.emulator-forced-colors-active-forced, input.emulator-forced-colors-active-forced, select.emulator-forced-colors-active-forced { text-decoration-color: rgb(61, 61, 61) !important; text-emphasis-color: rgb(61, 61, 61) !important; column-rule-color: rgb(61, 61, 61) !important;}button.emulator-forced-colors-active-forced, input.emulator-forced-colors-active-forced { border-left-color: rgb(32, 32, 32) !important; border-right-color: rgb(32, 32, 32) !important; border-top-color: rgb(32, 32, 32) !important; border-bottom-color: rgb(32, 32, 32) !important; border-inline-start-color: rgb(32, 32, 32) !important; border-inline-end-color: rgb(32, 32, 32) !important; border-block-start-color: rgb(32, 32, 32) !important; border-block-end-color: rgb(32, 32, 32) !important;}button.emulator-forced-colors-active-forced { color: rgb(32, 32, 32) !important; text-decoration-color: rgb(32, 32, 32) !important; text-emphasis-color: rgb(32, 32, 32) !important; outline-color: rgb(32, 32, 32) !important; column-rule-color: rgb(32, 32, 32) !important;}fieldset.emulator-forced-colors-active-forced { border-left-color: rgb(255, 250, 239) !important; border-right-color: rgb(255, 250, 239) !important; border-top-color: rgb(255, 250, 239) !important; border-bottom-color: rgb(255, 250, 239) !important; border-inline-start-color: rgb(255, 250, 239) !important; border-inline-end-color: rgb(255, 250, 239) !important; border-block-start-color: rgb(255, 250, 239) !important; border-block-end-color: rgb(255, 250, 239) !important;}input.emulator-forced-colors-active-forced { background-color: rgb(255, 250, 239) !important;}mark.emulator-forced-colors-active-forced { color: rgb(0, 0, 0) !important; background-color: rgb(255, 255, 0) !important; border-left-color: rgb(0, 0, 0) !important; border-right-color: rgb(0, 0, 0) !important; border-top-color: rgb(0, 0, 0) !important; border-bottom-color: rgb(0, 0, 0) !important; border-inline-start-color: rgb(0, 0, 0) !important; border-inline-end-color: rgb(0, 0, 0) !important; border-block-start-color: rgb(0, 0, 0) !important; border-block-end-color: rgb(0, 0, 0) !important; outline-color: rgb(0, 0, 0) !important;}body.emulator-forced-colors-active-forced { background-color: rgb(255, 250, 239) !important;}'
        );
    } else if (contrasttype == 'dusk') {
        lines.push(
            'a.emulator-forced-colors-active-forced, button.emulator-forced-colors-active-forced, abbr.emulator-forced-colors-active-forced, address.emulator-forced-colors-active-forced, area.emulator-forced-colors-active-forced, article.emulator-forced-colors-active-forced, aside.emulator-forced-colors-active-forced, audio.emulator-forced-colors-active-forced, b.emulator-forced-colors-active-forced, base.emulator-forced-colors-active-forced, bdi.emulator-forced-colors-active-forced, bdo.emulator-forced-colors-active-forced, blockquote.emulator-forced-colors-active-forced, body.emulator-forced-colors-active-forced, br.emulator-forced-colors-active-forced, canvas.emulator-forced-colors-active-forced, caption.emulator-forced-colors-active-forced, cite.emulator-forced-colors-active-forced, code.emulator-forced-colors-active-forced, col.emulator-forced-colors-active-forced, colgroup.emulator-forced-colors-active-forced, data.emulator-forced-colors-active-forced, datalist.emulator-forced-colors-active-forced, dd.emulator-forced-colors-active-forced, del.emulator-forced-colors-active-forced, details.emulator-forced-colors-active-forced, dfn.emulator-forced-colors-active-forced, div.emulator-forced-colors-active-forced, dl.emulator-forced-colors-active-forced, dt.emulator-forced-colors-active-forced, em.emulator-forced-colors-active-forced, embed.emulator-forced-colors-active-forced, fieldset.emulator-forced-colors-active-forced, figcaption.emulator-forced-colors-active-forced, figure.emulator-forced-colors-active-forced, footer.emulator-forced-colors-active-forced, form.emulator-forced-colors-active-forced, h1.emulator-forced-colors-active-forced, h2.emulator-forced-colors-active-forced, h3.emulator-forced-colors-active-forced, h4.emulator-forced-colors-active-forced, h5.emulator-forced-colors-active-forced, h6.emulator-forced-colors-active-forced, head.emulator-forced-colors-active-forced, header.emulator-forced-colors-active-forced, hgroup.emulator-forced-colors-active-forced, hr.emulator-forced-colors-active-forced, html.emulator-forced-colors-active-forced, i.emulator-forced-colors-active-forced, iframe.emulator-forced-colors-active-forced, img.emulator-forced-colors-active-forced, ins.emulator-forced-colors-active-forced, kbd.emulator-forced-colors-active-forced, label.emulator-forced-colors-active-forced, legend.emulator-forced-colors-active-forced, li.emulator-forced-colors-active-forced, link.emulator-forced-colors-active-forced, main.emulator-forced-colors-active-forced, map.emulator-forced-colors-active-forced, mark.emulator-forced-colors-active-forced, math.emulator-forced-colors-active-forced, menu.emulator-forced-colors-active-forced, meta.emulator-forced-colors-active-forced, meter.emulator-forced-colors-active-forced, nav.emulator-forced-colors-active-forced, noscript.emulator-forced-colors-active-forced, object.emulator-forced-colors-active-forced, ol.emulator-forced-colors-active-forced, optgroup.emulator-forced-colors-active-forced, option.emulator-forced-colors-active-forced, output.emulator-forced-colors-active-forced, p.emulator-forced-colors-active-forced, picture.emulator-forced-colors-active-forced, pre.emulator-forced-colors-active-forced, progress.emulator-forced-colors-active-forced, q.emulator-forced-colors-active-forced, rp.emulator-forced-colors-active-forced, rt.emulator-forced-colors-active-forced, ruby.emulator-forced-colors-active-forced, s.emulator-forced-colors-active-forced, samp.emulator-forced-colors-active-forced, script.emulator-forced-colors-active-forced, search.emulator-forced-colors-active-forced, section.emulator-forced-colors-active-forced, selectedcontent.emulator-forced-colors-active-forced, slot.emulator-forced-colors-active-forced, small.emulator-forced-colors-active-forced, source.emulator-forced-colors-active-forced, span.emulator-forced-colors-active-forced, strong.emulator-forced-colors-active-forced, style.emulator-forced-colors-active-forced, sub.emulator-forced-colors-active-forced, summary.emulator-forced-colors-active-forced, sup.emulator-forced-colors-active-forced, svg.emulator-forced-colors-active-forced, table.emulator-forced-colors-active-forced, tbody.emulator-forced-colors-active-forced, track.emulator-forced-colors-active-forced, wbr.emulator-forced-colors-active-forced, dialog.emulator-forced-colors-active-forced, input.emulator-forced-colors-active-forced, select.emulator-forced-colors-active-forced { -webkit-tap-highlight-color: rgba(0, 0, 0, 0.18) !important; fill: rgb(0, 0, 0) !important; stroke: none !important; box-shadow: none !important; text-shadow: none !important; background-image: none !important; scrollbar-color: auto !important;}a.emulator-forced-colors-active-forced, input.emulator-forced-colors-active-forced, abbr.emulator-forced-colors-active-forced, address.emulator-forced-colors-active-forced, area.emulator-forced-colors-active-forced, article.emulator-forced-colors-active-forced, aside.emulator-forced-colors-active-forced, audio.emulator-forced-colors-active-forced, b.emulator-forced-colors-active-forced, base.emulator-forced-colors-active-forced, bdi.emulator-forced-colors-active-forced, bdo.emulator-forced-colors-active-forced, blockquote.emulator-forced-colors-active-forced, body.emulator-forced-colors-active-forced, br.emulator-forced-colors-active-forced, canvas.emulator-forced-colors-active-forced, caption.emulator-forced-colors-active-forced, cite.emulator-forced-colors-active-forced, code.emulator-forced-colors-active-forced, col.emulator-forced-colors-active-forced, colgroup.emulator-forced-colors-active-forced, data.emulator-forced-colors-active-forced, datalist.emulator-forced-colors-active-forced, dd.emulator-forced-colors-active-forced, del.emulator-forced-colors-active-forced, details.emulator-forced-colors-active-forced, dfn.emulator-forced-colors-active-forced, dialog.emulator-forced-colors-active-forced, fieldset.emulator-forced-colors-active-forced, div.emulator-forced-colors-active-forced, dl.emulator-forced-colors-active-forced, dt.emulator-forced-colors-active-forced, em.emulator-forced-colors-active-forced, embed.emulator-forced-colors-active-forced, select.emulator-forced-colors-active-forced, figcaption.emulator-forced-colors-active-forced, figure.emulator-forced-colors-active-forced, footer.emulator-forced-colors-active-forced, form.emulator-forced-colors-active-forced, h1.emulator-forced-colors-active-forced, h2.emulator-forced-colors-active-forced, h3.emulator-forced-colors-active-forced, h4.emulator-forced-colors-active-forced, h5.emulator-forced-colors-active-forced, h6.emulator-forced-colors-active-forced, head.emulator-forced-colors-active-forced, header.emulator-forced-colors-active-forced, hgroup.emulator-forced-colors-active-forced, hr.emulator-forced-colors-active-forced, html.emulator-forced-colors-active-forced, i.emulator-forced-colors-active-forced, iframe.emulator-forced-colors-active-forced, img.emulator-forced-colors-active-forced, ins.emulator-forced-colors-active-forced, kbd.emulator-forced-colors-active-forced, label.emulator-forced-colors-active-forced, legend.emulator-forced-colors-active-forced, li.emulator-forced-colors-active-forced, link.emulator-forced-colors-active-forced, main.emulator-forced-colors-active-forced, map.emulator-forced-colors-active-forced, math.emulator-forced-colors-active-forced, menu.emulator-forced-colors-active-forced, meta.emulator-forced-colors-active-forced, meter.emulator-forced-colors-active-forced, nav.emulator-forced-colors-active-forced, noscript.emulator-forced-colors-active-forced, object.emulator-forced-colors-active-forced, ol.emulator-forced-colors-active-forced, optgroup.emulator-forced-colors-active-forced, option.emulator-forced-colors-active-forced, output.emulator-forced-colors-active-forced, p.emulator-forced-colors-active-forced, picture.emulator-forced-colors-active-forced, pre.emulator-forced-colors-active-forced, progress.emulator-forced-colors-active-forced, q.emulator-forced-colors-active-forced, rp.emulator-forced-colors-active-forced, rt.emulator-forced-colors-active-forced, ruby.emulator-forced-colors-active-forced, s.emulator-forced-colors-active-forced, samp.emulator-forced-colors-active-forced, script.emulator-forced-colors-active-forced, search.emulator-forced-colors-active-forced, section.emulator-forced-colors-active-forced, selectedcontent.emulator-forced-colors-active-forced, slot.emulator-forced-colors-active-forced, small.emulator-forced-colors-active-forced, source.emulator-forced-colors-active-forced, span.emulator-forced-colors-active-forced, strong.emulator-forced-colors-active-forced, style.emulator-forced-colors-active-forced, sub.emulator-forced-colors-active-forced, summary.emulator-forced-colors-active-forced, sup.emulator-forced-colors-active-forced, svg.emulator-forced-colors-active-forced, table.emulator-forced-colors-active-forced, tbody.emulator-forced-colors-active-forced, track.emulator-forced-colors-active-forced, wbr.emulator-forced-colors-active-forced { color: rgb(255, 255, 255) !important; outline-color: rgb(255, 255, 255) !important;}a.emulator-forced-colors-active-forced, dialog.emulator-forced-colors-active-forced, select.emulator-forced-colors-active-forced, abbr.emulator-forced-colors-active-forced, address.emulator-forced-colors-active-forced, area.emulator-forced-colors-active-forced, article.emulator-forced-colors-active-forced, aside.emulator-forced-colors-active-forced, audio.emulator-forced-colors-active-forced, b.emulator-forced-colors-active-forced, base.emulator-forced-colors-active-forced, bdi.emulator-forced-colors-active-forced, bdo.emulator-forced-colors-active-forced, blockquote.emulator-forced-colors-active-forced, body.emulator-forced-colors-active-forced, br.emulator-forced-colors-active-forced, canvas.emulator-forced-colors-active-forced, caption.emulator-forced-colors-active-forced, cite.emulator-forced-colors-active-forced, code.emulator-forced-colors-active-forced, col.emulator-forced-colors-active-forced, colgroup.emulator-forced-colors-active-forced, data.emulator-forced-colors-active-forced, datalist.emulator-forced-colors-active-forced, dd.emulator-forced-colors-active-forced, del.emulator-forced-colors-active-forced, details.emulator-forced-colors-active-forced, dfn.emulator-forced-colors-active-forced, div.emulator-forced-colors-active-forced, dl.emulator-forced-colors-active-forced, dt.emulator-forced-colors-active-forced, em.emulator-forced-colors-active-forced, embed.emulator-forced-colors-active-forced, figcaption.emulator-forced-colors-active-forced, figure.emulator-forced-colors-active-forced, footer.emulator-forced-colors-active-forced, form.emulator-forced-colors-active-forced, h1.emulator-forced-colors-active-forced, h2.emulator-forced-colors-active-forced, h3.emulator-forced-colors-active-forced, h4.emulator-forced-colors-active-forced, h5.emulator-forced-colors-active-forced, h6.emulator-forced-colors-active-forced, head.emulator-forced-colors-active-forced, header.emulator-forced-colors-active-forced, hgroup.emulator-forced-colors-active-forced, hr.emulator-forced-colors-active-forced, html.emulator-forced-colors-active-forced, i.emulator-forced-colors-active-forced, iframe.emulator-forced-colors-active-forced, img.emulator-forced-colors-active-forced, ins.emulator-forced-colors-active-forced, kbd.emulator-forced-colors-active-forced, label.emulator-forced-colors-active-forced, legend.emulator-forced-colors-active-forced, li.emulator-forced-colors-active-forced, link.emulator-forced-colors-active-forced, main.emulator-forced-colors-active-forced, map.emulator-forced-colors-active-forced, math.emulator-forced-colors-active-forced, menu.emulator-forced-colors-active-forced, meta.emulator-forced-colors-active-forced, meter.emulator-forced-colors-active-forced, nav.emulator-forced-colors-active-forced, noscript.emulator-forced-colors-active-forced, object.emulator-forced-colors-active-forced, ol.emulator-forced-colors-active-forced, optgroup.emulator-forced-colors-active-forced, option.emulator-forced-colors-active-forced, output.emulator-forced-colors-active-forced, p.emulator-forced-colors-active-forced, picture.emulator-forced-colors-active-forced, pre.emulator-forced-colors-active-forced, progress.emulator-forced-colors-active-forced, q.emulator-forced-colors-active-forced, rp.emulator-forced-colors-active-forced, rt.emulator-forced-colors-active-forced, ruby.emulator-forced-colors-active-forced, s.emulator-forced-colors-active-forced, samp.emulator-forced-colors-active-forced, script.emulator-forced-colors-active-forced, search.emulator-forced-colors-active-forced, section.emulator-forced-colors-active-forced, selectedcontent.emulator-forced-colors-active-forced, slot.emulator-forced-colors-active-forced, small.emulator-forced-colors-active-forced, source.emulator-forced-colors-active-forced, span.emulator-forced-colors-active-forced, strong.emulator-forced-colors-active-forced, style.emulator-forced-colors-active-forced, sub.emulator-forced-colors-active-forced, summary.emulator-forced-colors-active-forced, sup.emulator-forced-colors-active-forced, svg.emulator-forced-colors-active-forced, table.emulator-forced-colors-active-forced, tbody.emulator-forced-colors-active-forced, track.emulator-forced-colors-active-forced, wbr.emulator-forced-colors-active-forced { border-left-color: rgb(255, 255, 255) !important; border-right-color: rgb(255, 255, 255) !important; border-top-color: rgb(255, 255, 255) !important; border-bottom-color: rgb(255, 255, 255) !important; border-inline-start-color: rgb(255, 255, 255) !important; border-inline-end-color: rgb(255, 255, 255) !important; border-block-start-color: rgb(255, 255, 255) !important; border-block-end-color: rgb(255, 255, 255) !important;}a.emulator-forced-colors-active-forced, mark.emulator-forced-colors-active-forced, abbr.emulator-forced-colors-active-forced, address.emulator-forced-colors-active-forced, area.emulator-forced-colors-active-forced, article.emulator-forced-colors-active-forced, aside.emulator-forced-colors-active-forced, audio.emulator-forced-colors-active-forced, b.emulator-forced-colors-active-forced, base.emulator-forced-colors-active-forced, bdi.emulator-forced-colors-active-forced, bdo.emulator-forced-colors-active-forced, blockquote.emulator-forced-colors-active-forced, body.emulator-forced-colors-active-forced, br.emulator-forced-colors-active-forced, canvas.emulator-forced-colors-active-forced, caption.emulator-forced-colors-active-forced, cite.emulator-forced-colors-active-forced, code.emulator-forced-colors-active-forced, col.emulator-forced-colors-active-forced, colgroup.emulator-forced-colors-active-forced, data.emulator-forced-colors-active-forced, datalist.emulator-forced-colors-active-forced, dd.emulator-forced-colors-active-forced, del.emulator-forced-colors-active-forced, details.emulator-forced-colors-active-forced, dfn.emulator-forced-colors-active-forced, div.emulator-forced-colors-active-forced, dl.emulator-forced-colors-active-forced, dt.emulator-forced-colors-active-forced, em.emulator-forced-colors-active-forced, embed.emulator-forced-colors-active-forced, fieldset.emulator-forced-colors-active-forced, figcaption.emulator-forced-colors-active-forced, figure.emulator-forced-colors-active-forced, footer.emulator-forced-colors-active-forced, form.emulator-forced-colors-active-forced, h1.emulator-forced-colors-active-forced, h2.emulator-forced-colors-active-forced, h3.emulator-forced-colors-active-forced, h4.emulator-forced-colors-active-forced, h5.emulator-forced-colors-active-forced, h6.emulator-forced-colors-active-forced, head.emulator-forced-colors-active-forced, header.emulator-forced-colors-active-forced, hgroup.emulator-forced-colors-active-forced, hr.emulator-forced-colors-active-forced, html.emulator-forced-colors-active-forced, i.emulator-forced-colors-active-forced, iframe.emulator-forced-colors-active-forced, img.emulator-forced-colors-active-forced, ins.emulator-forced-colors-active-forced, kbd.emulator-forced-colors-active-forced, label.emulator-forced-colors-active-forced, legend.emulator-forced-colors-active-forced, li.emulator-forced-colors-active-forced, link.emulator-forced-colors-active-forced, main.emulator-forced-colors-active-forced, map.emulator-forced-colors-active-forced, math.emulator-forced-colors-active-forced, menu.emulator-forced-colors-active-forced, meta.emulator-forced-colors-active-forced, meter.emulator-forced-colors-active-forced, nav.emulator-forced-colors-active-forced, noscript.emulator-forced-colors-active-forced, object.emulator-forced-colors-active-forced, ol.emulator-forced-colors-active-forced, optgroup.emulator-forced-colors-active-forced, option.emulator-forced-colors-active-forced, output.emulator-forced-colors-active-forced, p.emulator-forced-colors-active-forced, picture.emulator-forced-colors-active-forced, pre.emulator-forced-colors-active-forced, progress.emulator-forced-colors-active-forced, q.emulator-forced-colors-active-forced, rp.emulator-forced-colors-active-forced, rt.emulator-forced-colors-active-forced, ruby.emulator-forced-colors-active-forced, s.emulator-forced-colors-active-forced, samp.emulator-forced-colors-active-forced, script.emulator-forced-colors-active-forced, search.emulator-forced-colors-active-forced, section.emulator-forced-colors-active-forced, selectedcontent.emulator-forced-colors-active-forced, slot.emulator-forced-colors-active-forced, small.emulator-forced-colors-active-forced, source.emulator-forced-colors-active-forced, span.emulator-forced-colors-active-forced, strong.emulator-forced-colors-active-forced, style.emulator-forced-colors-active-forced, sub.emulator-forced-colors-active-forced, summary.emulator-forced-colors-active-forced, sup.emulator-forced-colors-active-forced, svg.emulator-forced-colors-active-forced, table.emulator-forced-colors-active-forced, tbody.emulator-forced-colors-active-forced, track.emulator-forced-colors-active-forced, wbr.emulator-forced-colors-active-forced { text-decoration-color: rgb(0, 0, 0) !important; text-emphasis-color: rgb(0, 0, 0) !important; column-rule-color: rgb(0, 0, 0) !important;}a.emulator-forced-colors-active-forced, abbr.emulator-forced-colors-active-forced, address.emulator-forced-colors-active-forced, area.emulator-forced-colors-active-forced, article.emulator-forced-colors-active-forced, aside.emulator-forced-colors-active-forced, audio.emulator-forced-colors-active-forced, b.emulator-forced-colors-active-forced, base.emulator-forced-colors-active-forced, bdi.emulator-forced-colors-active-forced, bdo.emulator-forced-colors-active-forced, blockquote.emulator-forced-colors-active-forced, body.emulator-forced-colors-active-forced, br.emulator-forced-colors-active-forced, canvas.emulator-forced-colors-active-forced, caption.emulator-forced-colors-active-forced, cite.emulator-forced-colors-active-forced, code.emulator-forced-colors-active-forced, col.emulator-forced-colors-active-forced, colgroup.emulator-forced-colors-active-forced, data.emulator-forced-colors-active-forced, datalist.emulator-forced-colors-active-forced, dd.emulator-forced-colors-active-forced, del.emulator-forced-colors-active-forced, details.emulator-forced-colors-active-forced, dfn.emulator-forced-colors-active-forced, div.emulator-forced-colors-active-forced, dl.emulator-forced-colors-active-forced, dt.emulator-forced-colors-active-forced, em.emulator-forced-colors-active-forced, embed.emulator-forced-colors-active-forced, fieldset.emulator-forced-colors-active-forced, figcaption.emulator-forced-colors-active-forced, figure.emulator-forced-colors-active-forced, footer.emulator-forced-colors-active-forced, form.emulator-forced-colors-active-forced, h1.emulator-forced-colors-active-forced, h2.emulator-forced-colors-active-forced, h3.emulator-forced-colors-active-forced, h4.emulator-forced-colors-active-forced, h5.emulator-forced-colors-active-forced, h6.emulator-forced-colors-active-forced, head.emulator-forced-colors-active-forced, header.emulator-forced-colors-active-forced, hgroup.emulator-forced-colors-active-forced, hr.emulator-forced-colors-active-forced, html.emulator-forced-colors-active-forced, i.emulator-forced-colors-active-forced, iframe.emulator-forced-colors-active-forced, img.emulator-forced-colors-active-forced, ins.emulator-forced-colors-active-forced, kbd.emulator-forced-colors-active-forced, label.emulator-forced-colors-active-forced, legend.emulator-forced-colors-active-forced, li.emulator-forced-colors-active-forced, link.emulator-forced-colors-active-forced, main.emulator-forced-colors-active-forced, map.emulator-forced-colors-active-forced, math.emulator-forced-colors-active-forced, menu.emulator-forced-colors-active-forced, meta.emulator-forced-colors-active-forced, meter.emulator-forced-colors-active-forced, nav.emulator-forced-colors-active-forced, noscript.emulator-forced-colors-active-forced, object.emulator-forced-colors-active-forced, ol.emulator-forced-colors-active-forced, optgroup.emulator-forced-colors-active-forced, option.emulator-forced-colors-active-forced, output.emulator-forced-colors-active-forced, p.emulator-forced-colors-active-forced, picture.emulator-forced-colors-active-forced, pre.emulator-forced-colors-active-forced, progress.emulator-forced-colors-active-forced, q.emulator-forced-colors-active-forced, rp.emulator-forced-colors-active-forced, rt.emulator-forced-colors-active-forced, ruby.emulator-forced-colors-active-forced, s.emulator-forced-colors-active-forced, samp.emulator-forced-colors-active-forced, script.emulator-forced-colors-active-forced, search.emulator-forced-colors-active-forced, section.emulator-forced-colors-active-forced, selectedcontent.emulator-forced-colors-active-forced, slot.emulator-forced-colors-active-forced, small.emulator-forced-colors-active-forced, source.emulator-forced-colors-active-forced, span.emulator-forced-colors-active-forced, strong.emulator-forced-colors-active-forced, style.emulator-forced-colors-active-forced, sub.emulator-forced-colors-active-forced, summary.emulator-forced-colors-active-forced, sup.emulator-forced-colors-active-forced, svg.emulator-forced-colors-active-forced, table.emulator-forced-colors-active-forced, tbody.emulator-forced-colors-active-forced, track.emulator-forced-colors-active-forced, wbr.emulator-forced-colors-active-forced { background-color: rgba(45, 50, 54, 0) !important;}button.emulator-forced-colors-active-forced, dialog.emulator-forced-colors-active-forced, select.emulator-forced-colors-active-forced { background-color: rgb(45, 50, 54) !important;}dialog.emulator-forced-colors-active-forced, input.emulator-forced-colors-active-forced, select.emulator-forced-colors-active-forced { text-decoration-color: rgb(255, 255, 255) !important; text-emphasis-color: rgb(255, 255, 255) !important; column-rule-color: rgb(255, 255, 255) !important;}button.emulator-forced-colors-active-forced, input.emulator-forced-colors-active-forced { border-left-color: rgb(182, 246, 240) !important; border-right-color: rgb(182, 246, 240) !important; border-top-color: rgb(182, 246, 240) !important; border-bottom-color: rgb(182, 246, 240) !important; border-inline-start-color: rgb(182, 246, 240) !important; border-inline-end-color: rgb(182, 246, 240) !important; border-block-start-color: rgb(182, 246, 240) !important; border-block-end-color: rgb(182, 246, 240) !important;}button.emulator-forced-colors-active-forced { color: rgb(182, 246, 240) !important; text-decoration-color: rgb(182, 246, 240) !important; text-emphasis-color: rgb(182, 246, 240) !important; outline-color: rgb(182, 246, 240) !important; column-rule-color: rgb(182, 246, 240) !important;}fieldset.emulator-forced-colors-active-forced { border-left-color: rgb(45, 50, 54) !important; border-right-color: rgb(45, 50, 54) !important; border-top-color: rgb(45, 50, 54) !important; border-bottom-color: rgb(45, 50, 54) !important; border-inline-start-color: rgb(45, 50, 54) !important; border-inline-end-color: rgb(45, 50, 54) !important; border-block-start-color: rgb(45, 50, 54) !important; border-block-end-color: rgb(45, 50, 54) !important;}input.emulator-forced-colors-active-forced { background-color: rgb(45, 50, 54) !important;}mark.emulator-forced-colors-active-forced { color: rgb(0, 0, 0) !important; background-color: rgb(255, 255, 0) !important; border-left-color: rgb(0, 0, 0) !important; border-right-color: rgb(0, 0, 0) !important; border-top-color: rgb(0, 0, 0) !important; border-bottom-color: rgb(0, 0, 0) !important; border-inline-start-color: rgb(0, 0, 0) !important; border-inline-end-color: rgb(0, 0, 0) !important; border-block-start-color: rgb(0, 0, 0) !important; border-block-end-color: rgb(0, 0, 0) !important; outline-color: rgb(0, 0, 0) !important;} body.emulator-forced-colors-active-forced { background-color: rgb(45, 50, 54) !important;}'
        );
    } else if (contrasttype == 'night_sky') {
        lines.push(
            'a.emulator-forced-colors-active-forced, button.emulator-forced-colors-active-forced, abbr.emulator-forced-colors-active-forced, address.emulator-forced-colors-active-forced, area.emulator-forced-colors-active-forced, article.emulator-forced-colors-active-forced, aside.emulator-forced-colors-active-forced, audio.emulator-forced-colors-active-forced, b.emulator-forced-colors-active-forced, base.emulator-forced-colors-active-forced, bdi.emulator-forced-colors-active-forced, bdo.emulator-forced-colors-active-forced, blockquote.emulator-forced-colors-active-forced, body.emulator-forced-colors-active-forced, br.emulator-forced-colors-active-forced, canvas.emulator-forced-colors-active-forced, caption.emulator-forced-colors-active-forced, cite.emulator-forced-colors-active-forced, code.emulator-forced-colors-active-forced, col.emulator-forced-colors-active-forced, colgroup.emulator-forced-colors-active-forced, data.emulator-forced-colors-active-forced, datalist.emulator-forced-colors-active-forced, dd.emulator-forced-colors-active-forced, del.emulator-forced-colors-active-forced, details.emulator-forced-colors-active-forced, dfn.emulator-forced-colors-active-forced, div.emulator-forced-colors-active-forced, dl.emulator-forced-colors-active-forced, dt.emulator-forced-colors-active-forced, em.emulator-forced-colors-active-forced, embed.emulator-forced-colors-active-forced, fieldset.emulator-forced-colors-active-forced, figcaption.emulator-forced-colors-active-forced, figure.emulator-forced-colors-active-forced, footer.emulator-forced-colors-active-forced, form.emulator-forced-colors-active-forced, h1.emulator-forced-colors-active-forced, h2.emulator-forced-colors-active-forced, h3.emulator-forced-colors-active-forced, h4.emulator-forced-colors-active-forced, h5.emulator-forced-colors-active-forced, h6.emulator-forced-colors-active-forced, head.emulator-forced-colors-active-forced, header.emulator-forced-colors-active-forced, hgroup.emulator-forced-colors-active-forced, hr.emulator-forced-colors-active-forced, html.emulator-forced-colors-active-forced, i.emulator-forced-colors-active-forced, iframe.emulator-forced-colors-active-forced, img.emulator-forced-colors-active-forced, ins.emulator-forced-colors-active-forced, kbd.emulator-forced-colors-active-forced, label.emulator-forced-colors-active-forced, legend.emulator-forced-colors-active-forced, li.emulator-forced-colors-active-forced, link.emulator-forced-colors-active-forced, main.emulator-forced-colors-active-forced, map.emulator-forced-colors-active-forced, mark.emulator-forced-colors-active-forced, math.emulator-forced-colors-active-forced, menu.emulator-forced-colors-active-forced, meta.emulator-forced-colors-active-forced, meter.emulator-forced-colors-active-forced, nav.emulator-forced-colors-active-forced, noscript.emulator-forced-colors-active-forced, object.emulator-forced-colors-active-forced, ol.emulator-forced-colors-active-forced, optgroup.emulator-forced-colors-active-forced, option.emulator-forced-colors-active-forced, output.emulator-forced-colors-active-forced, p.emulator-forced-colors-active-forced, picture.emulator-forced-colors-active-forced, pre.emulator-forced-colors-active-forced, progress.emulator-forced-colors-active-forced, q.emulator-forced-colors-active-forced, rp.emulator-forced-colors-active-forced, rt.emulator-forced-colors-active-forced, ruby.emulator-forced-colors-active-forced, s.emulator-forced-colors-active-forced, samp.emulator-forced-colors-active-forced, script.emulator-forced-colors-active-forced, search.emulator-forced-colors-active-forced, section.emulator-forced-colors-active-forced, selectedcontent.emulator-forced-colors-active-forced, slot.emulator-forced-colors-active-forced, small.emulator-forced-colors-active-forced, source.emulator-forced-colors-active-forced, span.emulator-forced-colors-active-forced, strong.emulator-forced-colors-active-forced, style.emulator-forced-colors-active-forced, sub.emulator-forced-colors-active-forced, summary.emulator-forced-colors-active-forced, sup.emulator-forced-colors-active-forced, svg.emulator-forced-colors-active-forced, table.emulator-forced-colors-active-forced, tbody.emulator-forced-colors-active-forced, track.emulator-forced-colors-active-forced, wbr.emulator-forced-colors-active-forced, dialog.emulator-forced-colors-active-forced, input.emulator-forced-colors-active-forced, select.emulator-forced-colors-active-forced { -webkit-tap-highlight-color: rgba(0, 0, 0, 0.18) !important; fill: rgb(0, 0, 0) !important; stroke: none !important; box-shadow: none !important; text-shadow: none !important; background-image: none !important; scrollbar-color: auto !important;}a.emulator-forced-colors-active-forced, input.emulator-forced-colors-active-forced, abbr.emulator-forced-colors-active-forced, address.emulator-forced-colors-active-forced, area.emulator-forced-colors-active-forced, article.emulator-forced-colors-active-forced, aside.emulator-forced-colors-active-forced, audio.emulator-forced-colors-active-forced, b.emulator-forced-colors-active-forced, base.emulator-forced-colors-active-forced, bdi.emulator-forced-colors-active-forced, bdo.emulator-forced-colors-active-forced, blockquote.emulator-forced-colors-active-forced, body.emulator-forced-colors-active-forced, br.emulator-forced-colors-active-forced, canvas.emulator-forced-colors-active-forced, caption.emulator-forced-colors-active-forced, cite.emulator-forced-colors-active-forced, code.emulator-forced-colors-active-forced, col.emulator-forced-colors-active-forced, colgroup.emulator-forced-colors-active-forced, data.emulator-forced-colors-active-forced, datalist.emulator-forced-colors-active-forced, dd.emulator-forced-colors-active-forced, del.emulator-forced-colors-active-forced, details.emulator-forced-colors-active-forced, dfn.emulator-forced-colors-active-forced, dialog.emulator-forced-colors-active-forced, fieldset.emulator-forced-colors-active-forced, div.emulator-forced-colors-active-forced, dl.emulator-forced-colors-active-forced, dt.emulator-forced-colors-active-forced, em.emulator-forced-colors-active-forced, embed.emulator-forced-colors-active-forced, select.emulator-forced-colors-active-forced, figcaption.emulator-forced-colors-active-forced, figure.emulator-forced-colors-active-forced, footer.emulator-forced-colors-active-forced, form.emulator-forced-colors-active-forced, h1.emulator-forced-colors-active-forced, h2.emulator-forced-colors-active-forced, h3.emulator-forced-colors-active-forced, h4.emulator-forced-colors-active-forced, h5.emulator-forced-colors-active-forced, h6.emulator-forced-colors-active-forced, head.emulator-forced-colors-active-forced, header.emulator-forced-colors-active-forced, hgroup.emulator-forced-colors-active-forced, hr.emulator-forced-colors-active-forced, html.emulator-forced-colors-active-forced, i.emulator-forced-colors-active-forced, iframe.emulator-forced-colors-active-forced, img.emulator-forced-colors-active-forced, ins.emulator-forced-colors-active-forced, kbd.emulator-forced-colors-active-forced, label.emulator-forced-colors-active-forced, legend.emulator-forced-colors-active-forced, li.emulator-forced-colors-active-forced, link.emulator-forced-colors-active-forced, main.emulator-forced-colors-active-forced, map.emulator-forced-colors-active-forced, math.emulator-forced-colors-active-forced, menu.emulator-forced-colors-active-forced, meta.emulator-forced-colors-active-forced, meter.emulator-forced-colors-active-forced, nav.emulator-forced-colors-active-forced, noscript.emulator-forced-colors-active-forced, object.emulator-forced-colors-active-forced, ol.emulator-forced-colors-active-forced, optgroup.emulator-forced-colors-active-forced, option.emulator-forced-colors-active-forced, output.emulator-forced-colors-active-forced, p.emulator-forced-colors-active-forced, picture.emulator-forced-colors-active-forced, pre.emulator-forced-colors-active-forced, progress.emulator-forced-colors-active-forced, q.emulator-forced-colors-active-forced, rp.emulator-forced-colors-active-forced, rt.emulator-forced-colors-active-forced, ruby.emulator-forced-colors-active-forced, s.emulator-forced-colors-active-forced, samp.emulator-forced-colors-active-forced, script.emulator-forced-colors-active-forced, search.emulator-forced-colors-active-forced, section.emulator-forced-colors-active-forced, selectedcontent.emulator-forced-colors-active-forced, slot.emulator-forced-colors-active-forced, small.emulator-forced-colors-active-forced, source.emulator-forced-colors-active-forced, span.emulator-forced-colors-active-forced, strong.emulator-forced-colors-active-forced, style.emulator-forced-colors-active-forced, sub.emulator-forced-colors-active-forced, summary.emulator-forced-colors-active-forced, sup.emulator-forced-colors-active-forced, svg.emulator-forced-colors-active-forced, table.emulator-forced-colors-active-forced, tbody.emulator-forced-colors-active-forced, track.emulator-forced-colors-active-forced, wbr.emulator-forced-colors-active-forced { color: rgb(255, 255, 255) !important; outline-color: rgb(255, 255, 255) !important;}a.emulator-forced-colors-active-forced, dialog.emulator-forced-colors-active-forced, select.emulator-forced-colors-active-forced, abbr.emulator-forced-colors-active-forced, address.emulator-forced-colors-active-forced, area.emulator-forced-colors-active-forced, article.emulator-forced-colors-active-forced, aside.emulator-forced-colors-active-forced, audio.emulator-forced-colors-active-forced, b.emulator-forced-colors-active-forced, base.emulator-forced-colors-active-forced, bdi.emulator-forced-colors-active-forced, bdo.emulator-forced-colors-active-forced, blockquote.emulator-forced-colors-active-forced, body.emulator-forced-colors-active-forced, br.emulator-forced-colors-active-forced, canvas.emulator-forced-colors-active-forced, caption.emulator-forced-colors-active-forced, cite.emulator-forced-colors-active-forced, code.emulator-forced-colors-active-forced, col.emulator-forced-colors-active-forced, colgroup.emulator-forced-colors-active-forced, data.emulator-forced-colors-active-forced, datalist.emulator-forced-colors-active-forced, dd.emulator-forced-colors-active-forced, del.emulator-forced-colors-active-forced, details.emulator-forced-colors-active-forced, dfn.emulator-forced-colors-active-forced, div.emulator-forced-colors-active-forced, dl.emulator-forced-colors-active-forced, dt.emulator-forced-colors-active-forced, em.emulator-forced-colors-active-forced, embed.emulator-forced-colors-active-forced, figcaption.emulator-forced-colors-active-forced, figure.emulator-forced-colors-active-forced, footer.emulator-forced-colors-active-forced, form.emulator-forced-colors-active-forced, h1.emulator-forced-colors-active-forced, h2.emulator-forced-colors-active-forced, h3.emulator-forced-colors-active-forced, h4.emulator-forced-colors-active-forced, h5.emulator-forced-colors-active-forced, h6.emulator-forced-colors-active-forced, head.emulator-forced-colors-active-forced, header.emulator-forced-colors-active-forced, hgroup.emulator-forced-colors-active-forced, hr.emulator-forced-colors-active-forced, html.emulator-forced-colors-active-forced, i.emulator-forced-colors-active-forced, iframe.emulator-forced-colors-active-forced, img.emulator-forced-colors-active-forced, ins.emulator-forced-colors-active-forced, kbd.emulator-forced-colors-active-forced, label.emulator-forced-colors-active-forced, legend.emulator-forced-colors-active-forced, li.emulator-forced-colors-active-forced, link.emulator-forced-colors-active-forced, main.emulator-forced-colors-active-forced, map.emulator-forced-colors-active-forced, math.emulator-forced-colors-active-forced, menu.emulator-forced-colors-active-forced, meta.emulator-forced-colors-active-forced, meter.emulator-forced-colors-active-forced, nav.emulator-forced-colors-active-forced, noscript.emulator-forced-colors-active-forced, object.emulator-forced-colors-active-forced, ol.emulator-forced-colors-active-forced, optgroup.emulator-forced-colors-active-forced, option.emulator-forced-colors-active-forced, output.emulator-forced-colors-active-forced, p.emulator-forced-colors-active-forced, picture.emulator-forced-colors-active-forced, pre.emulator-forced-colors-active-forced, progress.emulator-forced-colors-active-forced, q.emulator-forced-colors-active-forced, rp.emulator-forced-colors-active-forced, rt.emulator-forced-colors-active-forced, ruby.emulator-forced-colors-active-forced, s.emulator-forced-colors-active-forced, samp.emulator-forced-colors-active-forced, script.emulator-forced-colors-active-forced, search.emulator-forced-colors-active-forced, section.emulator-forced-colors-active-forced, selectedcontent.emulator-forced-colors-active-forced, slot.emulator-forced-colors-active-forced, small.emulator-forced-colors-active-forced, source.emulator-forced-colors-active-forced, span.emulator-forced-colors-active-forced, strong.emulator-forced-colors-active-forced, style.emulator-forced-colors-active-forced, sub.emulator-forced-colors-active-forced, summary.emulator-forced-colors-active-forced, sup.emulator-forced-colors-active-forced, svg.emulator-forced-colors-active-forced, table.emulator-forced-colors-active-forced, tbody.emulator-forced-colors-active-forced, track.emulator-forced-colors-active-forced, wbr.emulator-forced-colors-active-forced { border-left-color: rgb(255, 255, 255) !important; border-right-color: rgb(255, 255, 255) !important; border-top-color: rgb(255, 255, 255) !important; border-bottom-color: rgb(255, 255, 255) !important; border-inline-start-color: rgb(255, 255, 255) !important; border-inline-end-color: rgb(255, 255, 255) !important; border-block-start-color: rgb(255, 255, 255) !important; border-block-end-color: rgb(255, 255, 255) !important;}a.emulator-forced-colors-active-forced, abbr.emulator-forced-colors-active-forced, address.emulator-forced-colors-active-forced, area.emulator-forced-colors-active-forced, article.emulator-forced-colors-active-forced, aside.emulator-forced-colors-active-forced, audio.emulator-forced-colors-active-forced, b.emulator-forced-colors-active-forced, base.emulator-forced-colors-active-forced, bdi.emulator-forced-colors-active-forced, bdo.emulator-forced-colors-active-forced, blockquote.emulator-forced-colors-active-forced, body.emulator-forced-colors-active-forced, br.emulator-forced-colors-active-forced, canvas.emulator-forced-colors-active-forced, caption.emulator-forced-colors-active-forced, cite.emulator-forced-colors-active-forced, code.emulator-forced-colors-active-forced, col.emulator-forced-colors-active-forced, colgroup.emulator-forced-colors-active-forced, data.emulator-forced-colors-active-forced, datalist.emulator-forced-colors-active-forced, dd.emulator-forced-colors-active-forced, del.emulator-forced-colors-active-forced, details.emulator-forced-colors-active-forced, dfn.emulator-forced-colors-active-forced, div.emulator-forced-colors-active-forced, dl.emulator-forced-colors-active-forced, dt.emulator-forced-colors-active-forced, em.emulator-forced-colors-active-forced, embed.emulator-forced-colors-active-forced, fieldset.emulator-forced-colors-active-forced, figcaption.emulator-forced-colors-active-forced, figure.emulator-forced-colors-active-forced, footer.emulator-forced-colors-active-forced, form.emulator-forced-colors-active-forced, h1.emulator-forced-colors-active-forced, h2.emulator-forced-colors-active-forced, h3.emulator-forced-colors-active-forced, h4.emulator-forced-colors-active-forced, h5.emulator-forced-colors-active-forced, h6.emulator-forced-colors-active-forced, head.emulator-forced-colors-active-forced, header.emulator-forced-colors-active-forced, hgroup.emulator-forced-colors-active-forced, hr.emulator-forced-colors-active-forced, html.emulator-forced-colors-active-forced, i.emulator-forced-colors-active-forced, iframe.emulator-forced-colors-active-forced, img.emulator-forced-colors-active-forced, ins.emulator-forced-colors-active-forced, kbd.emulator-forced-colors-active-forced, label.emulator-forced-colors-active-forced, legend.emulator-forced-colors-active-forced, li.emulator-forced-colors-active-forced, link.emulator-forced-colors-active-forced, main.emulator-forced-colors-active-forced, map.emulator-forced-colors-active-forced, math.emulator-forced-colors-active-forced, menu.emulator-forced-colors-active-forced, meta.emulator-forced-colors-active-forced, meter.emulator-forced-colors-active-forced, nav.emulator-forced-colors-active-forced, noscript.emulator-forced-colors-active-forced, object.emulator-forced-colors-active-forced, ol.emulator-forced-colors-active-forced, optgroup.emulator-forced-colors-active-forced, option.emulator-forced-colors-active-forced, output.emulator-forced-colors-active-forced, p.emulator-forced-colors-active-forced, picture.emulator-forced-colors-active-forced, pre.emulator-forced-colors-active-forced, progress.emulator-forced-colors-active-forced, q.emulator-forced-colors-active-forced, rp.emulator-forced-colors-active-forced, rt.emulator-forced-colors-active-forced, ruby.emulator-forced-colors-active-forced, s.emulator-forced-colors-active-forced, samp.emulator-forced-colors-active-forced, script.emulator-forced-colors-active-forced, search.emulator-forced-colors-active-forced, section.emulator-forced-colors-active-forced, selectedcontent.emulator-forced-colors-active-forced, slot.emulator-forced-colors-active-forced, small.emulator-forced-colors-active-forced, source.emulator-forced-colors-active-forced, span.emulator-forced-colors-active-forced, strong.emulator-forced-colors-active-forced, style.emulator-forced-colors-active-forced, sub.emulator-forced-colors-active-forced, summary.emulator-forced-colors-active-forced, sup.emulator-forced-colors-active-forced, svg.emulator-forced-colors-active-forced, table.emulator-forced-colors-active-forced, tbody.emulator-forced-colors-active-forced, track.emulator-forced-colors-active-forced, wbr.emulator-forced-colors-active-forced { background-color: rgba(0, 0, 0, 0) !important; text-decoration-color: rgb(0, 0, 0) !important; text-emphasis-color: rgb(0, 0, 0) !important; column-rule-color: rgb(0, 0, 0) !important;}button.emulator-forced-colors-active-forced, dialog.emulator-forced-colors-active-forced, select.emulator-forced-colors-active-forced { background-color: rgb(0, 0, 0) !important;}dialog.emulator-forced-colors-active-forced, input.emulator-forced-colors-active-forced, select.emulator-forced-colors-active-forced { text-decoration-color: rgb(255, 255, 255) !important; text-emphasis-color: rgb(255, 255, 255) !important; column-rule-color: rgb(255, 255, 255) !important;}button.emulator-forced-colors-active-forced, input.emulator-forced-colors-active-forced { border-left-color: rgb(255, 238, 50) !important; border-right-color: rgb(255, 238, 50) !important; border-top-color: rgb(255, 238, 50) !important; border-bottom-color: rgb(255, 238, 50) !important; border-inline-start-color: rgb(255, 238, 50) !important; border-inline-end-color: rgb(255, 238, 50) !important; border-block-start-color: rgb(255, 238, 50) !important; border-block-end-color: rgb(255, 238, 50) !important;}fieldset.emulator-forced-colors-active-forced, mark.emulator-forced-colors-active-forced { border-left-color: rgb(0, 0, 0) !important; border-right-color: rgb(0, 0, 0) !important; border-top-color: rgb(0, 0, 0) !important; border-bottom-color: rgb(0, 0, 0) !important; border-inline-start-color: rgb(0, 0, 0) !important; border-inline-end-color: rgb(0, 0, 0) !important; border-block-start-color: rgb(0, 0, 0) !important; border-block-end-color: rgb(0, 0, 0) !important;}button.emulator-forced-colors-active-forced { color: rgb(255, 238, 50) !important; text-decoration-color: rgb(255, 238, 50) !important; text-emphasis-color: rgb(255, 238, 50) !important; outline-color: rgb(255, 238, 50) !important; column-rule-color: rgb(255, 238, 50) !important;}input.emulator-forced-colors-active-forced { background-color: rgb(0, 0, 0) !important;}mark.emulator-forced-colors-active-forced { color: rgb(0, 0, 0) !important; background-color: rgb(255, 255, 0) !important; text-decoration-color: rgb(0, 0, 0) !important; text-emphasis-color: rgb(0, 0, 0) !important; outline-color: rgb(0, 0, 0) !important; column-rule-color: rgb(0, 0, 0) !important;} body.emulator-forced-colors-active-forced { background-color: rgb(0, 0, 0) !important;}'
        );
    }
    const cssContent = lines.join('\n');
    try {
        fs.writeFileSync(cssFilePath, cssContent, 'utf8');
        console.log(`Zapisano zmienne CSS do ${cssFilePath}`);
    } catch (err) {
        console.error('BÅ‚Ä…d zapisu pliku CSS:', err);
    }
}

ipcMain.handle('contrast-type', (event, contrast_type_value) => {
    contrasttype = contrast_type_value;
    saveVariablesToFile(cssVariables);
});

// IPC - ustawia pojedynczÄ… zmiennÄ… i od razu zapisuje do pliku
ipcMain.handle('set-css-variable', (event, key, value) => {
    if (value === null) {
        delete cssVariables[key];
    } else {
        cssVariables[key] = value;
    }
    saveVariablesToFile(cssVariables);
    return true;
});

// IPC - dodaje nowÄ… zmiennÄ… i zapisuje do pliku (praktycznie to samo co set)
ipcMain.handle('add-css-variable', (event, key, value) => {
    cssVariables[key] = value;
    saveVariablesToFile(cssVariables);
    return true;
});

// IPC - zwraca wszystkie zmienne
ipcMain.handle('get-css-variables', () => {
    return cssVariables;
});

app.whenReady().then(() => {
    session.defaultSession.clearCache();
    const mainWindow = new BrowserWindow({
        width: 600,
        height: 350,
        frame: false,
        resizable: false,
        webPreferences: {
            preload: path.join(__dirname, 'preload.js'),
            contextIsolation: true,
            nodeIntegration: false
            //devTools: false
        }
    });
    mainWindow.loadFile('emulator/index.html');
    ipcMain.handle('open-bend-window', async (event, options) => {
        session.defaultSession.clearCache();
        const { width, height, bend, mod } = options;
        newWin1 = new BrowserWindow({
            width,
            height,
            frame: false,
            resizable: false,
            webPreferences: {
                preload: path.join(__dirname, 'preload.js'),
                contextIsolation: true,
                nodeIntegration: false,
                additionalArguments: [`--bend=${bend}`, `--width=${width}`, `--height=${height}`, `--mod=${mod}`]
            }
        });
        newWin1.loadFile('emulator/screen.html');
        originalWidth = newWin1.getBounds().width;
        originalHeight = newWin1.getBounds().height;
    });
});
